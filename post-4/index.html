<!DOCTYPE html>
<html lang="en"  class="theme--light" >

<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GCWFNJEHB4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GCWFNJEHB4');
</script>

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://Cvn1n.github.io/images/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://Cvn1n.github.io/images/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://Cvn1n.github.io/images/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://Cvn1n.github.io/images/apple-touch-icon-57x57.png" />
  <link rel="short icon" href="https://Cvn1n.github.io/images/favicon.png" type="image/x-icon" />
  <link rel="stylesheet" href="https://Cvn1n.github.io/style.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" rel="stylesheet">
  <title>Viva&#x27;s Blos • Windows环境下通过LLaMA-Factory微调ChatGLM2-6B模型流程</title>
  
  
  <link rel="alternate" type="application/rss+xml" title="Viva&#x27;s Blos" href="https://Cvn1n.github.io/rss.xml">
  
  
  
  
</head>

<body>
  <div id="sidebar" class="animated fadeInDown">
    <div class="logo-title">
      <div class="title">
        <img src=https://Cvn1n.github.io/images/logo@2x.png style="width:127px;" alt="logo" />
        <h3><a href="https://Cvn1n.github.io/">Viva&#x27;s Blos</a></h3>
        <div class="description">
          <p>有趣的人是不同寻常的，不同寻常的人是怪人，所以怪人是有趣的</p>
        </div>
      </div>
    </div>
    <ul class="social-links">
      
    </ul>
    <div class="footer">
      
      <span> </span>Viva Viva! La Revolución!!！</a>
      <div class="by_zola"><a href="https://ai.anique.jp/en/login?callbackUrl=%2F" target="_blank">Ｌｅｔ＇ｓ  ａｌｌ  ｌｏｖｅ  Ｌａｉｎ！ </a></div>
      <span> </span> Message by-Viva.</a>
      <span> </span> Could you love me?.</a>
      
    </div>
  </div>
  <div id="main">
    <div class="page-top animated fadeInDown">
      <div class="nav">
        
        
        
        
        <li><a  href="https://Cvn1n.github.io/">主页</a></li>
        <li><a  href="https://Cvn1n.github.io/about/">关于</a></li><li><a  href="https://Cvn1n.github.io/tags">标签</a></li><li><a 
            href="https://Cvn1n.github.io/archive/">归档</a></li><li><a  href="https://Cvn1n.github.io/links/">友情链接</a></li><li><a  href="https://Cvn1n.github.io/say/">奇思妙想&#x2F;杂言琐记</a></li>

      </div>
      <div class="information">
        <div class="back_btn">
          <a onclick="window.history.go(-1)" ><i
              class="fas fa-chevron-left"></i></a>
        </div>
        
        
        
        <div class="avatar"><img src="https://Cvn1n.github.io/images/avatar.jpg"></div>
      </div>
    </div>
    <div class="autopagerize_page_element">
      <div class="content">
        
<article class="post animated fadeInDown">
  <h1><a href="https:&#x2F;&#x2F;Cvn1n.github.io&#x2F;post-4&#x2F;">Windows环境下通过LLaMA-Factory微调ChatGLM2-6B模型流程</a></h1>
  
  <div class="post-content"><h1 id="windowshuan-jing-xia-tong-guo-llama-factorywei-diao-chatglm2-6bmo-xing">Windows环境下通过LLaMA-Factory微调ChatGLM2-6B模型</h1>
<p>嘛——我永远是个与时代脱轨的人。
这是上一年的东西了
想捏角色，所以就来玩玩</p>
<p>本教程适用于  windows环境通过LLaMA-Factory微调ChatGLM2-6B模型</p>
<h2 id="guan-yu-chatglm3-6b">关于ChatGLM3-6B</h2>
<h3 id="ying-jian-xu-qiu">硬件需求</h3>
<table><thead><tr><th>量化等级</th><th>最低GPU(对话)</th><th>最低GPU(微调)</th></tr></thead><tbody>
<tr><td>FP16（标准）</td><td>13GB</td><td>14GB</td></tr>
<tr><td>INT8</td><td>8GB</td><td>9GB</td></tr>
<tr><td>INT4</td><td>6GB</td><td>7GB</td></tr>
</tbody></table>
<h3 id="jie-shao">介绍</h3>
<blockquote>
<p><a href="https://github.com/THUDM/ChatGLM-6B">ChatGLM-6B</a>是由清华大学KEG实验室和智谱AI联合开源的、基于GLM架构（ChatGPT是基于GPT架构）、支持中英双语的对话语言模型。它拥有62亿参数（也是其名称中6B的来源，这两方之前也开源了参数更大的ChatGLM-130B模型），并且针对中文问答和对话进行了专门优化。
<br>
而 <a href="https://github.com/THUDM/ChatGLM2-6B">ChatGLM2-6B</a>是开源中英双语对话模型 <a href="https://github.com/THUDM/ChatGLM-6B">ChatGLM-6B</a> 的第二代版本，在保留了初代模型对话流畅、部署门槛较低等众多优秀特性的基础之上，<a href="https://github.com/THUDM/ChatGLM2-6B">ChatGLM2-6B</a> 增加了不少性能，具体可以去github看。</p>
</blockquote>
<p>1.该模型目前最适合中文训练
<br>
2.该模型有思想钢印
<br>
3.6B体量有限 具有局限性</p>
<h2 id="xiang-xi-bu-zou">详细步骤</h2>
<h3 id="yi-huan-jing-zhun-bei">一、环境准备</h3>
<h4 id="huan-jing-1-cuda">环境1-<a href="https://so.csdn.net/so/search?q=CUDA&amp;spm=1001.2101.3001.7020">CUDA</a></h4>
<p>ask:&quot;为什么要安装这个?&quot;
<br>
这个架构可以让显卡更好的处理深度学习的计算
<br>
几乎所有深度学习框架都首选cuda作为底层加速库
<br>
ChatGLM也不例外</p>
<p>ask:&quot;在哪下载&quot;
<br>
可以直接去官网：<a href="https://developer.nvidia.com/cuda-downloads" title="CUDA Toolkit 12.3 Update 1 Downloads | NVIDIA Developer">CUDA Toolkit 12.3 Update 1 Downloads | NVIDIA Developer</a></p>
<h4 id="huan-jing-2-an-zhuang-python-3-10yi-shang-ban-ben">环境2-安装Python 3.10以上版本</h4>
<p>chatglm需要Python 3.10以上版本
<br>
下载安装Python：<a href="https://www.python.org/downloads/">Python官网</a></p>
<h4 id="huan-jing-3-an-zhuang-anacondapei-zhi-pythonhuan-jing">环境3- 安装anaconda配置python环境</h4>
<p>下载安装anaconda：<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" title="Index of /anaconda/archive/ | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror">清华大学开源镜像网站</a>
<br>
一路Next到底就好</p>
<p>安装完成后在系统环境变量中找到Path，新建 如下图所示，确定
<br>
<a href="https://imgse.com/i/pF8D0de"><img src="https://s11.ax1x.com/2024/02/13/pF8D0de.md.png" alt="pF8D0de.md.png" /></a></p>
<p>路径\Anaconda
<br>
路径\Anaconda\Scripts
<br>
路径\Anaconda\Library\bin
<br>
路径\Anaconda\Library\mingw-w64\bin
<br>
路径\Anaconda\Library\usr\bin</p>
<h3 id="er-huo-qu-mo-xing">二、获取模型</h3>
<p>如果你没有Git，先去安装下吧</p>
<pre><code>git clone https:&#x2F;&#x2F;github.com&#x2F;THUDM&#x2F;ChatGLM3.git
</code></pre>
<br>
然后使用 pip 安装依赖：
<br>
```
pip install -r requirements.txt
```
<br>
(这个命令会自动根据它们提供的requirements.txt安装chatglm需要的东西)
<h3 id="san-pei-zhi-mo-xing-de-huan-jing-bian-liang">三、配置模型的环境变量</h3>
<p>到系统环境变量
<br>
在系统变量中分别新建下面(路径自己改到正确的!!)</p>
<p>变量名：MODEL_PATH
<br>
变量值：模型的根目录路径
<br>
(示例D:\CHAGML\ChatGLM3)</p>
<p>变量名：IPYKERNEL
<br>
变量值：chatglm3-demo</p>
<h3 id="si-huo-qu-chatglm3de-xun-lian-mo-xing">四、获取ChatGLM3的训练模型</h3>
<p>ChatGLM3目录下开cmd窗口</p>
<pre><code>git lfs install
git clone https:&#x2F;&#x2F;huggingface.co&#x2F;THUDM&#x2F;chatglm3-6b
</code></pre>
<h3 id="wu-an-zhuang-qi-dong-llama-factory">五、安装启动LLaMA-Factory</h3>
<p>找个位置，新建文件夹，文件夹下开cmd</p>
<pre><code>clone https:&#x2F;&#x2F;github.com&#x2F;hiyouga&#x2F;LLaMA-Factory.git
conda create -n llama_factory python=3.10
conda activate llama_factory
cd LLaMA-Factory
pip install -r requirements.txt
</code></pre>
<p>之后每次启动 从LLaMA-Factory所在的文件夹下 开CMD
<br>
执行下面两条即可</p>
<pre><code>conda activate llama_factory
python src&#x2F;train_web.py
</code></pre>
<p>运行后，可以通过访问网页使用。</p>
<h2 id="zui-hou">最后</h2>
<p>//如果你不知道如何自定训练数据，LLaMA-Factory\data下有很多数据文件夹，可以提供参考
<br>
//玩得开心</p>
<hr />
<p>最新更新于 2024/2/13</p>
</div>
  <div class="post-footer">
    <div class="meta">
      <div class="info">
        
        <i class="far fa-sun"></i><span class="date">2024-02-13</span>
        
        
        <i class="fas fa-tags"></i>
        
        <a class="tag" href="https://Cvn1n.github.io/tags/教程">&nbsp;教程</a>
        
        <a class="tag" href="https://Cvn1n.github.io/tags/自然语言处理">&nbsp;自然语言处理</a>
        
        
      </div>
    </div>
  </div>
</article>
<div class="share">
  <div class="telegram">
    <a class="fab fa-telegram"
      href="https://t.me/Barbara3Jefferson4"></a>
  </div>
</div>







<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['$$', '$$'], ["\\[", "\\]"]],
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>




      </div>
    </div>
  </div>
  
  <script>
    function showLanguages() {
      let currentDisplay = document.getElementById("languages").style.display;
      if (currentDisplay == 'none') {
        document.getElementById("languages").style.display = 'block';
      } else {
        document.getElementById("languages").style.display = 'none';
      }
    }
  </script>
</body>

</html>
